var events = require("events");
var util = require("util");

function PairBarriers(extPin, intPin) {
    if (!(this instanceof PairBarriers)) {
        return new PairBarriers(extPin, intPin);
    };

    var five = require("johnny-five");
    var scope = this;

    var externalBarrier =  new five.Barrier(extPin);
    var internalBarrier =  new five.Barrier(intPin);
    var combination = {
            external: false,
            internal: false
        };

    var triggerChangedCombination = function(){
        scope.emit('changedCombination', combination);
    };

    externalBarrier
        .on('up', function(){
            combination.external = false;
            triggerChangedCombination();

    })
       .on('down', function(){
            combination.external = true;
            triggerChangedCombination();
    });
     internalBarrier
       .on('up', function(){
            combination.internal = false;
            triggerChangedCombination();
    })
       .on('down', function(){
            combination.internal = true;
            triggerChangedCombination();
    });
};

util.inherits(PairBarriers, events.EventEmitter);

module.exports = PairBarriers;


